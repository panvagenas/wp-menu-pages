(function(f){wpMenuPages=f.extend({statesKey:"state",pageOptionsKey:"pageOptions",wpDateFormat:"F j, Y",wpTimeFormat:"g:i a",dateTimePicker:{icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"fa fa-crosshairs",clear:"fa fa-trash-o",close:"fa fa-times"},dateFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss",weekFormat:"ww",monthFormat:"MM"}},wpMenuPages);var b={readSingleFileAsText:function(x,y){var w=x.target.files[0];if(w){var v=new FileReader();v.onload=y;v.readAsText(w)}return false}};var t={ctrlSaveBtnSelector:".btn-save-options",ctrlResetBtnSelector:".btn-reset-options",ctrlTabResetBtnSelector:".btn-tab-reset-options",ctrlExportOptsSelector:".btn-export-options",ctrlImportOptsSelector:".btn-import-options",ctrlAllControlsSelector:".wp-menu-pages-control",activeTabSelector:".tab-pane.active",select2Selector:".select2.wp-menu-pages-input",getActiveTab:function(){return f(this.activeTabSelector)},getSaveBtn:function(){return f(this.ctrlSaveBtnSelector)},getResetBtn:function(){return f(this.ctrlResetBtnSelector)},getTabResetBtn:function(){return f(this.ctrlTabResetBtnSelector)},getExportBtn:function(){return f(this.ctrlExportOptsSelector)},getImportBtn:function(){return f(this.ctrlImportOptsSelector)},getAllControls:function(){return f(this.ctrlAllControlsSelector)}};var d={getActiveTabOptions:function(){var v=t.getActiveTab().find("form");return v.serialize()}};var j="help-block";var u="input-error";var e="."+j+"."+u;var c={helpBlockClass:j,helpBlockErrorClass:u,helpBlockErrorSelector:e,helpBlockTemplate:'<span id="{{id}}" class="'+j+" "+u+'">{{msg}}</span>',inputHasErrorClass:"has-error",inputStandardClass:"wp-menu-pages-input",markInvalid:function(y,z){if(typeof y=="string"){y=this.getByName(y,false)}if(z==undefined||z.length==0||!y||y.length==undefined||y.length==0){return}var w=z.join("<br />");var v=this.helpBlockTemplate.replace("{{msg}}",w).replace("{{id}}",y.attr("name")+"-error");var x=y.closest(".form-group");x.addClass(this.inputHasErrorClass);x.find(this.helpBlockErrorSelector).remove();y.after(v)},markValid:function(w){if(typeof w=="string"){w=this.getByName(w,false)}if(!w||w.length==undefined||w.length==0){return}var v=w.closest(".form-group");v.removeClass(this.inputHasErrorClass);v.find(this.helpBlockErrorSelector).remove()},getByName:function(x,w){w=w==undefined;var v=w?t.getActiveTab():f(".wp-menu-pages-ns");return v.find("."+this.inputStandardClass+"#"+x)},updateValues:function(v){if(v==undefined||v.length==0){return[]}for(var y in v){if(!v.hasOwnProperty(y)){continue}var x=v[y];var w=this.getByName(y,false);if(w==undefined||w.length==0){continue}if(w.attr("type")=="radio"){this.updateRadioValue(y,x);continue}w.val(x);w.trigger("change")}},updateRadioValue:function(v,w){f("#"+v+'[value="'+w+'"]').parent().button("toggle")},isSelect2:function(w){var v=w instanceof jQuery?w:this.getByName(w,false);if(v&&v.length>0){return v.is(t.select2Selector)}return false}};var a={domSelector:".select2.wp-menu-pages-input",count:function(){return this.getElements().length},hasElements:function(){return this.count()>0},getElements:function(){return f(this.domSelector)},getElementOptions:function(v){return v.data()},isBinded:function(v){return v.data("select2")},maybeUnbind:function(v){if(this.isBinded(v)){v.select2("destroy")}},bindAll:function(){var v=this;v.getElements().each(function(){var w=f(this);v.maybeUnbind(w);var x=v.getElementOptions(w);w.select2(x)})},maybeBindAll:function(){if(this.hasElements()){this.bindAll()}},isSelect2:function(v){return c.isSelect2(v)}};var h=".alerts-wrapper";var i=f(h);var n={TYPE_SUCCESS:"success",TYPE_INFO:"info",TYPE_WARNING:"warning",TYPE_DANGER:"danger",alertsWrapperSelector:h,$alertsWrapper:i,alertTemplate:'<div class="alert alert-{{type}} alert-dismissible fade in" role="alert" style="display: none;"><button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>{{msg}}</div>',alert:function(v,y,x){var w=f(this.getAlertMarkUp(y,v));f(this.alertsWrapperSelector).append(w);w.slideDown("fast");if(x){setTimeout(function(){w.slideUp(function(){w.remove()})},x)}w.alert()},success:function(w,v){this.alert(this.TYPE_SUCCESS,w,v)},info:function(w,v){this.alert(this.TYPE_INFO,w,v)},warning:function(w,v){this.alert(this.TYPE_WARNING,w,v)},danger:function(w,v){this.alert(this.TYPE_DANGER,w,v)},getAlertMarkUp:function(w,v){return this.alertTemplate.replace("{{type}}",v).replace("{{msg}}",w)}};var l={loadingClass:"loading",loading:function(w,y,x){if(!(w instanceof jQuery)){w=f(w)}var v=w.find("i");if(y){v.addClass(this.loadingClass);if(x){w.attr("disabled","disabled")}return}v.removeClass("loading");w.attr("disabled",false)},bindControls:function(){t.getSaveBtn().click(function(v){v.preventDefault();k.saveOptions(d.getActiveTabOptions())});t.getResetBtn().click(function(v){v.preventDefault();k.resetOptions()});t.getTabResetBtn().click(function(v){v.preventDefault();k.resetOptions(d.getActiveTabOptions())});t.getExportBtn().click(function(v){v.preventDefault();k.exportOptions()});t.getImportBtn().click(function(v){v.preventDefault();f("#import-options-input").click()});f("#import-options-input").change(function(w){w.preventDefault();var v=confirm("This will overwrite all current options.\nAre you sure you want to do that?");if(v!=true){return}b.readSingleFileAsText(w.originalEvent,function(y){try{var z=JSON.parse(y.target.result);k.importOptions(z)}catch(x){alert("There was an error reading options file:\n"+x.message)}})});f('a[data-toggle="tab"]').on("shown.bs.tab",function(w){var v=f(w.target);var y=f(w.relatedTarget);var x={state:{active:v.data("title"),inActive:y.data("title")}};a.maybeBindAll();k.updateCoreOptions(x)})}};var g="wp-menu-pages-";var m=g+"save-options-";var q=g+"reset-options-";var p=g+"export-options-";var s=g+"import-options-";var o=g+"update-core-options-";var k={ajaxUrl:ajaxurl,context:wpMenuPages.context,actionPrefix:"wp-menu-pages-",actionSavePrefix:m,actionResetPrefix:q,actionExportPrefix:p,actionImportPrefix:s,actionUpdateCoreOptionsPrefix:o,post:function(y,v,x,z,w){f.ajax({url:this.ajaxUrl,method:"POST",data:y,success:z,complete:v,error:x,dataType:w?w:"json"})},saveOptions:function(A){var y=this.actionSavePrefix+this.context;var x={options:A,action:y,nonce:wpMenuPages.nonce[y]};l.loading(t.getSaveBtn(),true,true);var z=function(C){if(C.data!=undefined&&C.data.options!=undefined){var B=C.data.options;for(var D in B){if(!B.hasOwnProperty(D)){continue}if(B[D].valid){c.markValid(D);continue}c.markInvalid(D,B[D].errors)}}if(C.success==undefined||C.success==false){n.danger("There was an error saving the options");return false}n.success("Options Saved!",2000);return true};var w=function(){n.danger("There was an error saving the options")};var v=function(){l.loading(t.getSaveBtn(),false)};this.post(x,v,w,z)},exportOptions:function(){var y=this.actionExportPrefix+this.context;var x={action:y,nonce:wpMenuPages.nonce[y]};l.loading(t.getExportBtn(),true,true);var z=function(B){if(B.success==undefined||B.success==false){w(B);return false}var A=new Blob([B.data.options],{type:"application/json;charset=utf-8;"});saveAs(A,B.data.name+".json");return true};var v=function(){l.loading(t.getExportBtn(),false)};var w=function(){n.danger("There was an error while trying to prepare your download")};this.post(x,v,w,z)},importOptions:function(A){if(A.length==0){return}var y=this.actionImportPrefix+this.context;var x={action:y,nonce:wpMenuPages.nonce[y],options:A};l.loading(t.getAllControls(),true,true);var z=function(B){if(B.success==undefined||B.success==false){w(B);return false}n.success("Options Import Successful",2000);if(B.data!=undefined&&B.data.options!=undefined){c.updateValues(B.data.options)}return true};var v=function(){l.loading(t.getAllControls(),false)};var w=function(){n.danger("There was an error while importing options")};this.post(x,v,w,z)},resetOptions:function(v){var z=this.actionResetPrefix+this.context;var y={action:z,nonce:wpMenuPages.nonce[z]};if(v){y.include=v}l.loading(t.getResetBtn(),true,true);l.loading(t.getTabResetBtn(),true,true);var A=function(B){if(B.success==undefined||B.success==false){x(B);return false}n.success("All Options Have Been Reset to Defaults",2000);if(B.data!=undefined&&B.data.defaults!=undefined){c.updateValues(B.data.defaults)}return true};var w=function(){l.loading(t.getResetBtn(),false);l.loading(t.getTabResetBtn(),false)};var x=function(){n.danger("There was an error reseting options")};this.post(y,w,x,A)},updateCoreOptions:function(x){var w=this.actionUpdateCoreOptionsPrefix+this.context;var v={options:x,action:w,nonce:wpMenuPages.nonce[w]};this.post(v)}};var r={markup:'<div class="modal fade" tabindex="-1" role="dialog"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">{{title}}</h4> </div> <div class="modal-body">{{body}} </div> <div class="modal-footer">{{footer}} </div> </div> </div> </div>',getMarkUp:function(w,v,x){return this.markup.replace("{{title}}",w).replace("{{body}}",v).replace("{{footer}}",x)}};f(function(){l.bindControls();var y=f("input.date");var x=f("input.datetime");var w=f("input.month");var v=f("input.time");y.datetimepicker({format:wpMenuPages.dateTimePicker.dateFormat,icons:wpMenuPages.dateTimePicker.icons});x.datetimepicker({format:wpMenuPages.dateTimePicker.dateFormat+" "+wpMenuPages.dateTimePicker.timeFormat,icons:wpMenuPages.dateTimePicker.icons});w.datetimepicker({format:wpMenuPages.dateTimePicker.monthFormat,icons:wpMenuPages.dateTimePicker.icons});v.datetimepicker({format:wpMenuPages.dateTimePicker.timeFormat,icons:wpMenuPages.dateTimePicker.icons})})})(jQuery);