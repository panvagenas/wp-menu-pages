(function(d){wpMenuPages=d.extend({statesKey:"state",pageOptionsKey:"pageOptions",wpDateFormat:"F j, Y",wpTimeFormat:"g:i a",dateTimePicker:{icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"fa fa-crosshairs",clear:"fa fa-trash-o",close:"fa fa-times"},dateFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss",weekFormat:"ww",monthFormat:"MM"}},wpMenuPages);var b={readSingleFileAsText:function(p,q){var o=p.target.files[0];if(o){var n=new FileReader();n.onload=q;n.readAsText(o)}return false}};var h={ctrlSaveBtnSelector:".btn-save-options",ctrlResetBtnSelector:".btn-reset-options",ctrlTabResetBtnSelector:".btn-tab-reset-options",ctrlExportOptsSelector:".btn-export-options",ctrlImportOptsSelector:".btn-import-options",ctrlAllControlsSelector:".wp-menu-pages-control",activeTabSelector:".tab-pane.active",select2Selector:".select2.wp-menu-pages-input",getActiveTab:function(){return d(this.activeTabSelector)},getSaveBtn:function(){return d(this.ctrlSaveBtnSelector)},getResetBtn:function(){return d(this.ctrlResetBtnSelector)},getTabResetBtn:function(){return d(this.ctrlTabResetBtnSelector)},getExportBtn:function(){return d(this.ctrlExportOptsSelector)},getImportBtn:function(){return d(this.ctrlImportOptsSelector)},getAllControls:function(){return d(this.ctrlAllControlsSelector)}};var a={getActiveTabOptions:function(){var n=h.getActiveTab().find("form");return n.serialize()}};var f="help-block";var m="input-error";var l="."+f+"."+m;var i={helpBlockClass:f,helpBlockErrorClass:m,helpBlockErrorSelector:l,helpBlockTemplate:'<span id="{{id}}" class="'+f+" "+m+'">{{msg}}</span>',inputHasErrorClass:"has-error",inputStandardClass:"wp-menu-pages-input",markInvalid:function(q,r){if(typeof q=="string"){q=this.getByName(q,false)}if(r==undefined||r.length==0||!q||q.length==undefined||q.length==0){return}var o=r.join("<br />");var n=this.helpBlockTemplate.replace("{{msg}}",o).replace("{{id}}",q.attr("name")+"-error");var p=q.closest(".form-group");p.addClass(this.inputHasErrorClass);p.find(this.helpBlockErrorSelector).remove();q.after(n)},markValid:function(o){if(typeof o=="string"){o=this.getByName(o,false)}if(!o||o.length==undefined||o.length==0){return}var n=o.closest(".form-group");n.removeClass(this.inputHasErrorClass);n.find(this.helpBlockErrorSelector).remove()},getByName:function(p,o){o=o==undefined;var n=o?h.getActiveTab():d(".wp-menu-pages-ns");return n.find("."+this.inputStandardClass+"#"+p)},updateValues:function(n){if(n==undefined||n.length==0){return[]}for(var q in n){if(!n.hasOwnProperty(q)){continue}var p=n[q];var o=this.getByName(q,false);if(o==undefined||o.length==0){continue}if(o.attr("type")=="radio"){this.updateRadioValue(q,p);continue}o.val(p);o.trigger("change")}},updateRadioValue:function(n,o){d("#"+n+'[value="'+o+'"]').parent().button("toggle")},isSelect2:function(o){var n=o instanceof jQuery?o:this.getByName(o,false);if(n&&n.length>0){return n.is(h.select2Selector)}return false}};var c={domSelector:".select2.wp-menu-pages-input",count:function(){return this.getElements().length},hasElements:function(){return this.count()>0},getElements:function(){return d(this.domSelector)},getElementOptions:function(n){return n.data()},isBinded:function(n){return n.data("select2")},maybeUnbind:function(n){if(this.isBinded(n)){n.select2("destroy")}},bindAll:function(){var n=this;n.getElements().each(function(){var o=d(this);n.maybeUnbind(o);var p=n.getElementOptions(o);o.select2(p)})},maybeBindAll:function(){if(this.hasElements()){this.bindAll()}},isSelect2:function(n){return i.isSelect2(n)}};var e={TYPE_SUCCESS:"success",TYPE_INFO:"info",TYPE_WARNING:"warning",TYPE_DANGER:"danger",alertsWrapperSelector:".alerts-wrapper",alertTemplate:'<div class="alert alert-{{type}} alert-dismissible fade in" role="alert" style="display: none;"><button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>{{msg}}</div>',alert:function(n,q,p){var o=d(this.getAlertMarkUp(q,n));d(this.alertsWrapperSelector).append(o);o.slideDown("fast");if(p){setTimeout(function(){o.slideUp(function(){o.remove()})},p)}o.alert()},success:function(o,n){this.alert(this.TYPE_SUCCESS,o,n)},info:function(o,n){this.alert(this.TYPE_INFO,o,n)},warning:function(o,n){this.alert(this.TYPE_WARNING,o,n)},danger:function(o,n){this.alert(this.TYPE_DANGER,o,n)},getAlertMarkUp:function(o,n){return this.alertTemplate.replace("{{type}}",n).replace("{{msg}}",o)}};var k={loadingClass:"loading",loading:function(o,q,p){if(!(o instanceof jQuery)){o=d(o)}var n=o.find("i");if(q){n.addClass(this.loadingClass);if(p){o.attr("disabled","disabled")}return}n.removeClass("loading");o.attr("disabled",false)},bindControls:function(){h.getSaveBtn().click(function(n){n.preventDefault();g.saveOptions(a.getActiveTabOptions())});h.getResetBtn().click(function(n){n.preventDefault();g.resetOptions()});h.getTabResetBtn().click(function(n){n.preventDefault();g.resetOptions(a.getActiveTabOptions())});h.getExportBtn().click(function(n){n.preventDefault();g.exportOptions()});h.getImportBtn().click(function(n){n.preventDefault();d("#import-options-input").click()});d("#import-options-input").change(function(o){o.preventDefault();var n=confirm("This will overwrite all current options.\nAre you sure you want to do that?");if(n!=true){return}b.readSingleFileAsText(o.originalEvent,function(q){try{var r=JSON.parse(q.target.result);g.importOptions(r)}catch(p){alert("There was an error reading options file:\n"+p.message)}})});d('a[data-toggle="tab"]').on("shown.bs.tab",function(o){var n=d(o.target);var q=d(o.relatedTarget);var p={state:{active:n.data("title"),inActive:q.data("title")}};c.maybeBindAll();g.updateCoreOptions(p)})}};var g={ajaxUrl:ajaxurl,context:wpMenuPages.context,post:function(q,n,p,r,o){d.ajax({url:this.ajaxUrl,method:"POST",data:q,success:r,complete:n,error:p,dataType:o?o:"json"})},saveOptions:function(s){var q=wpMenuPages.actionSavePrefix+this.context;var p={options:s,action:q,nonce:wpMenuPages.nonce[q]};k.loading(h.getSaveBtn(),true,true);var r=function(u){if(u.data!=undefined&&u.data.options!=undefined){var t=u.data.options;for(var v in t){if(!t.hasOwnProperty(v)){continue}if(t[v].valid){i.markValid(v);continue}i.markInvalid(v,t[v].errors)}}if(u.success==undefined||u.success==false){e.danger("There was an error saving the options");return false}e.success("Options Saved!",2000);return true};var o=function(){e.danger("There was an error saving the options")};var n=function(){k.loading(h.getSaveBtn(),false)};this.post(p,n,o,r)},exportOptions:function(){var q=wpMenuPages.actionExportPrefix+this.context;var p={action:q,nonce:wpMenuPages.nonce[q]};k.loading(h.getExportBtn(),true,true);var r=function(t){if(t.success==undefined||t.success==false){o(t);return false}var s=new Blob([t.data.options],{type:"application/json;charset=utf-8;"});saveAs(s,t.data.name+".json");return true};var n=function(){k.loading(h.getExportBtn(),false)};var o=function(){e.danger("There was an error while trying to prepare your download")};this.post(p,n,o,r)},importOptions:function(s){if(s.length==0){return}var q=wpMenuPages.actionImportPrefix+this.context;var p={action:q,nonce:wpMenuPages.nonce[q],options:s};k.loading(h.getAllControls(),true,true);var r=function(t){if(t.success==undefined||t.success==false){o(t);return false}e.success("Options Import Successful",2000);if(t.data!=undefined&&t.data.options!=undefined){i.updateValues(t.data.options)}return true};var n=function(){k.loading(h.getAllControls(),false)};var o=function(){e.danger("There was an error while importing options")};this.post(p,n,o,r)},resetOptions:function(n){var r=wpMenuPages.actionResetPrefix+this.context;var q={action:r,nonce:wpMenuPages.nonce[r]};if(n){q.include=n}k.loading(h.getResetBtn(),true,true);k.loading(h.getTabResetBtn(),true,true);var s=function(t){if(t.success==undefined||t.success==false){p(t);return false}e.success("All Options Have Been Reset to Defaults",2000);if(t.data!=undefined&&t.data.defaults!=undefined){i.updateValues(t.data.defaults)}return true};var o=function(){k.loading(h.getResetBtn(),false);k.loading(h.getTabResetBtn(),false)};var p=function(){e.danger("There was an error reseting options")};this.post(q,o,p,s)},updateCoreOptions:function(p){var o=wpMenuPages.actionUpdateCoreOptionsPrefix+this.context;var n={options:p,action:o,nonce:wpMenuPages.nonce[o]};this.post(n)}};var j={markup:'<div class="modal fade" tabindex="-1" role="dialog"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">{{title}}</h4> </div> <div class="modal-body">{{body}} </div> <div class="modal-footer">{{footer}} </div> </div> </div> </div>',getMarkUp:function(o,n,p){return this.markup.replace("{{title}}",o).replace("{{body}}",n).replace("{{footer}}",p)}};d(function(){k.bindControls();var q=d("input.date");var p=d("input.datetime");var o=d("input.month");var n=d("input.time");q.datetimepicker({format:wpMenuPages.dateTimePicker.dateFormat,icons:wpMenuPages.dateTimePicker.icons});p.datetimepicker({format:wpMenuPages.dateTimePicker.dateFormat+" "+wpMenuPages.dateTimePicker.timeFormat,icons:wpMenuPages.dateTimePicker.icons});o.datetimepicker({format:wpMenuPages.dateTimePicker.monthFormat,icons:wpMenuPages.dateTimePicker.icons});n.datetimepicker({format:wpMenuPages.dateTimePicker.timeFormat,icons:wpMenuPages.dateTimePicker.icons})})})(jQuery);